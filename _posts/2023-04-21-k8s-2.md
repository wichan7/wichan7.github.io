---
title: "쿠버네티스 - 2 [업데이트중]"
categories: 
  - infrastructure
tags:
  - kubernetes
  - k8s
---

# 프로비저닝
## 프로비저닝이란..
사용자의 요구에 맞게 시스템 자원을 할당, 배치, 배포해 두었다가 필요 시 시스템을 즉시 사용할 수 있는 상태로 미리 준비해 두는 것을 말한다.

## 프로비저닝 방법 선택
k8s를 프로비저닝하기 위한 유명한 방법으로 3가지가 있다. 
1. kubernetes  
여러 클러스터 구성 요소들을 직접 설치하고 설정한다.  
1. kubeadm  
k8s를 쉽게 구현할 수 있도록 도와주는 부트스트랩 툴이다.   
k8s에서 공식적으로 지원하고, 업데이트하는 k8s 구현 툴이다.
1. kops  
kubeadm과 마찬가지로 쉽게 구현하기 위한 부트스트랩 툴이나, '클라우드 플랫폼' 에서 쉽게 k8s를 설치할 수 있도록 도와주는 도구이다.

학습자의 입장으로... (1)을 배우면 좋겠다만, 너무 어려워 클러스터 구성도 전에 포기할 것만 같았다.  
(1)에 대한 튜토리얼은 다음 문서를 참고하길.. '[kubernetes-the-hard-way-tutorial](https://github.com/kelseyhightower/kubernetes-the-hard-way)'  
  

타협을 봐서.. 너무 많은 부분을 서포트하는 kops를 제하고, kubeadm으로 먼저 스터디하고, 기능에 익숙해지면 1을 공부해보자.  

# 구성요소 설치하기
참조1: [ec2에 kubeadm 설치](https://velog.io/@eunbyul/AWS-EC2%EC%97%90-kubernetes-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0)  


## linux repository 설정하기 
1. docker, containerd 설치를 위해 repo를 설정한다.
```
cd /etc/yum.repos.d
sudo wget https://download.docker.com/linux/centos/docker-ce.repo
```

2. kubectl, kubeadm, kubelet 설치를 위해 repo를 설정한다. 
```
cat <<EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
exclude=kubelet kubeadm kubectl
EOF
```

## docker, dockerd, kubectl, kubeadm, kubelet 설치
sudo yum install docker-ce docker-ce-cli containerd.io
sudo yum install kubelet kubeadm kubectl --disableexcludes=kubernetes


## Selinux의 설정을 permissive 모드로 변경
```
sudo setenforce 0
sudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config
sudo yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes
sudo systemctl enable --now kubelet
```